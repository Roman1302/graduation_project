## 1.3 Описание методологии разработки сервиса

В тексте описанном выше было отмечено, что Python - отличный выбор для создания Telegram-бота для Telegram. Теперь рассмотрим необходимые библиотеки этого языка для разработки такого Telegram-бота.

В Python есть несколько полезных модулей при создании  Telegram-бота, которые рассмотрим ниже.

Фрймворков для написания Telegram-ботов очень много. Из популярных – есть aiogram, telebot, telethon, python-telegram-bot. Есть и no code решения по созданию Telegram-ботов.

Здесь разберём какие библиотеки или решения существуют, их плюсы и минусы и границы применимости.

Первой рассмотрим библиотеку python-telegram-bot. Библиотека поддерживает сразу 2 версии: синхронную и асинхронную. Синхронная – это версии 13.X. Асинхронная – в том же репозитории, просто для неё нужно установить версию библиотеки 20.X и старше.

За счёт этого библиотека дружелюбнее для начинающих, пусть это и создаёт некоторую путаницу для новичков.

Библиотека обладает более подробной документацией в сравнении с aiogram, есть статьи об архитектуре, спам-лимитах Telegram. Функционал, кажется, более насыщенным.

Из минусов – библиотека не обладает таким же активным коммьюнити, как aiogram, в репозитории которого есть ссылки на сообщества по странам.

Второй библиотекой рассмотрим telethon. Эта библиотека нужна уже если есть желание сделать не обычного бота в Telegram, а подключить Python уже к аккаунту в Telegram и роботизировать его. Получится, что Python-скрипт как бы управляет аккаунтом, в то время как библиотеки выше управляют ботами, которые в рамках Telegram являются отдельными сущностями, так же, как и каналы или группы.

Это подходит далеко не под все проекты и нужно не во всех ситуациях. Пригодится, например, если есть желание писать пользователям первыми, так как Telegram-боты так делать не умеют. Но и попасть под запрет из-за спама так тоже куда легче, чем если работать с Telegram-ботом.

Документация библиотеки тоже весьма подробная и иногда даже раскрывает дополнительные темы, вроде философии библиотеки или чёрной магией, не предусмотренной библиотекой.

Telebot – простая в использовании библиотека для создания ботов для Telegram. Она предоставляет множество функций, которые позволяют легко создавать Telegram-ботов, включая поддержку клавиатур, обработку сообщений и многое другое. Telebot также имеет большое сообщество пользователей и разработчиков, которые могут помочь решить любые проблемы, с которыми  может столкнуться программист.

Рассматривая преимущества Telebot можно выделить следующие: простота использования, большое сообщество пользователей и разработчиков, хорошая документация. Из недостатков выделяются: ограниченный функционал, не поддерживает работу с базами данных, могут возникнуть проблемы с производительностью при обработке большого количества запросов

В завершении опишем aiogram. Самый популярный вариант, который фигурирует практически в каждой статье о Telegram-боте. Самое распространённое ошибочное мнение него – что асинхронность ускорит Telegram-бота. На самом деле, aiogram сделает это, но для этого недостаточно просто писать async и await в начале объявления или вызова функций. Для асинхронной работы Telegram-бота все операции внутри неё не должны быть блокирующими (или хотя бы какая-то ощутимая их часть). Это значит, что больше нельзя пользоваться бибилотекой requests, ведь она синхронная, а нужен её асинхронный аналог, например, httpx или asks. Нельзя пользоваться redis, нужен aioredis. И так далее.

Библиотека хороша для написания асинхронного кода.

Создание ботов для Telegram - это важная задача для многих программистов и бизнес-владельцев. Когда дело доходит до выбора библиотеки для создания Telegram-ботов, две наиболее наиболее популярные опции, которые можно рассмотреть, это Aiogram и Telebot.

Создание ботов для Telegram - это одна из важных задач, которую многие программисты и предприниматели ставят перед собой. Когда речь заходит о выборе библиотеки, существуют две самые популярные опции - Aiogram и Telebot. У обеих библиотек есть свои плюсы и минусы, и окончательный выбор зависит от индивидуальных потребностей и предпочтений. Так что рассмотрим все варианты внимательно, чтобы сделать правильный выбор.

Aiogram – более новая библиотека для создания ботов для Telegram, которая предоставляет больше гибкости и возможностей, чем Telebot. Aiogram имеет более сложный API, который позволяет создавать более сложные функции, такие как обработка аудио, видео и файлов, а также поддерживает работу с базами данных. Aiogram также имеет активное сообщество пользователей и разработчиков, которые могут помочь решить любые проблемы, с которыми может столкнуться разработчик.

Выбор между Aiogram и Telebot обусловлен собственными требованиями и предпочтениями. Если нужна простая в использовании библиотека с базовым функционалом, то лучшим выбором будет Telebot. Если же использовать более гибкую и функциональную библиотеку, которая поддерживает работу с базами данных, тогда Aiogram может оказаться оптимальным решением для выбора. В любом случае, обе библиотеки предоставляют огромное количество возможностей для создания ботов для Telegram, и выбор зависит от  потребностей и уровня опыта в данной сфере.

Автор проекта выбрал для использования библиотеку Aiogram, так как в проекте есть базы данных, что не поддерживает библиотека Telebot.

Далее опишем какие модули были использованы при написании проекта.

Asyncio - этот модуль для написания параллельного кода с использованием синтаксиса async или await. Asyncio используется в качестве основы для нескольких асинхронных модулей Python, которые предоставляют высокопроизводительные сетевые и веб-серверы, библиотеки подключений к базе данных, распределенные очереди задач и т.д.

Основные характеристики aiohttp: поддержка HTTP-протокола как на стороне клиента, так и на стороне сервера. Поддерживает как клиентские, так и серверные веб-сокеты «из коробки» и позволяет избежать чрезмерного запроса обратного вызова.

Signal представляет собой список зарегистрированных асинхронных обратных вызовов. Жизненный цикл сигнала состоит из двух этапов: после создания его содержимое может быть заполнено с помощью стандартных операций со списком.

Async-timeout - менеджер контекста тайм-аута, совместимый с asyncio.

Asyncpg - это библиотека интерфейса базы данных, разработанная специально для PostgreSQL и Python. Asyncpg - это эффективная, чистая реализация двоичного протокола сервера PostgreSQL для использования с asyncio фреймворком Python.

Attrs - это пакет Python, который избавив от рутинной работы по реализации объектных протоколов.

Dnspython предоставляет как высокоуровневый, так и низкоуровневый доступ к DNS. Классы высокого уровня выполняют запросы к данным с заданным именем, типом и классом и возвращают набор ответов. Классы низкого уровня позволяют напрямую манипулировать зонами DNS, сообщениями, именами и записями.

Gino - это асинхронная ORM (Объектно-реляционное отображение) библиотека для работы с базами данных в Python. Она обеспечивает высокую производительность и простой интерфейс для работы с базой данных.

Основные особенности Gino:

    • Асинхронная поддержка основана на асинхронном подходе, позволяя приложениям работать быстро и эффективно с базами данных.

    • Простота использования предоставляет интуитивно понятный API для работы с базой данных. Легко выполняет запросы, создаёт, изменяя и удаляет записи.

    • Поддержка различных баз данных совместима с различными базами данных, такие как PostgreSQL, MySQL, SQLite и другими.

    • Миграции базы данных предоставляет инструменты для управления миграциями базы данных, облегчая изменение структуры базы данных.

Пакет greenlet является дополнительной компонентой для версии CPython под названием Stackless, который обеспечивает поддержку микропотоков, известных как «тасклеты». Тасклеты запускаются псевдо-одновременно в одном или нескольких потоках операционной системы и синхронизируются с помощью обмена данными через «каналы».

Multidict — это специальный вид словаря, который предназначен для удобной работы с несколькими значениями одного и того же ключа. Такая функциональность особенно полезна в синтаксическом анализе, который широко используется в различных оболочках. Зачастую в подобных задачах требуется работать с различными значениями, связанными с одним ключом, и именно здесь подкласс словаря multidict приходит на помощь. Он облегчает манипуляции с данными и позволяет эффективно работать с различными значениями, обеспечивая удобство и гибкость в процессе анализа.

Pymongo, представляющий собой пакет для Python, является набором инструментов, предназначенных для работы с MongoDB. Это является оптимальным выбором для взаимодействия с базой данных MongoDB из Python.

Пакет python-dotenv предоставляет удобный способ считывания пар ключ-значение из файла .env и загрузки переменных окружения, необходимых для вашего приложения. Этот небольшой инструмент значительно облегчает работу с окружением и упрощает настройку переменных для вашего проекта.

Pytz, как библиотека, осуществляет функции преобразования даты и времени, что делает ее незаменимой для работы с международными клиентами.

SQLAlchemy — это программное обеспечение с открытым исходным кодом для работы с базами данных при помощи языка SQL. Оно реализует технологию программирования ORM (Object-Relational Mapping), которая связывает базы данных с концепциями объектно-ориентированных языков программирования. SQLAlchemy позволяет описывать структуры баз данных и способы взаимодействия с ними прямо на языке Python.

Yarl это сервис лимитирования нагрузки для распределённых сервисов. Его особенность в том, что он способен работать с миллионами квот, имея при этом очень низкие накладные расходы на проверку квоты. Если совсем кратко, это система распределённых Leaky Bucket'ов, с помощью которых можно ограничивать разные величины, связанные со временем: скорость передачи данных по сети, запросы в секунду и т. п.

Таким образом, главным для создания и подключения Telegram-бота необходимо использовать модуль aiogram - это современный и полностью асинхронный фреймворк для Telegram Bot API, написанный на Python с asyncio и aiohttp. Эта библиотека предоставляет удобный и высокоуровневый интерфейс для взаимодействия с API Telegram, что позволяет разработчикам легко создавать и настраивать функциональность Telegram-ботов.